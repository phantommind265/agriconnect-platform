{% extends "base.html" %}
{% block content %}

<div class="chat-container" style="max-width: 600px; margin: 30px auto; background: #fff; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); padding: 20px;">

    <h2 style="text-align:center; margin-bottom: 15px; font-size: 1.5rem; color: #333;">
        üí¨ Chat with <span style="color:#28a745;">{{ other_user['username'] }}</span>
    </h2>

    <!-- Chat messages container -->
    <div class="chat-box" style="border:1px solid #ddd; border-radius: 10px; padding:15px; height:350px; overflow-y:auto; background:#f9f9f9;">
        {% for msg in messages %}
            {% if msg['sender_id'] == current_user.id %}
                <div style="text-align:right; margin-bottom: 10px;">
                    <span style="display:inline-block; background:#d4edda; color:#155724; padding:10px; border-radius:15px; max-width:70%; text-align:left;">
                        {{ msg['content'] }}
                    </span><br>
                    <small style="font-size: 0.8rem; color:#888;">{{ msg['timestamp'] }}</small>
                </div>
            {% else %}
                <div style="text-align:left; margin-bottom: 10px;">
                    <span style="display:inline-block; background:#e2e3e5; color:#383d41; padding:10px; border-radius:15px; max-width:70%; text-align:left;">
                        <strong>{{ msg['sender_name'] }}:</strong> {{ msg['content'] }}
                    </span><br>
                    <small style="font-size: 0.8rem; color:#888;">{{ msg['timestamp'] }}</small>
                </div>
            {% endif %}
        {% endfor %}
    </div>

    <!-- Message input -->
    <form method="POST" style="margin-top: 15px;">
        {{ form.hidden_tag() }}
        <div style="display: flex; gap: 10px;">
            {{ form.content(class="form-control", placeholder="Type a message...", style="flex:1; padding:10px; border-radius: 8px; border:1px solid #ccc;") }}
            {{ form.submit(class="btn btn-success", style="padding:10px 20px; border-radius: 8px;") }}
        </div>
    </form>

    <!-- Back link -->
    <div style="margin-top: 15px; text-align:center;">
        <a href="{{ url_for('message_bp.users_list') }}" style="color:#007bff; text-decoration:none; font-weight:bold;">‚Üê Back to chats</a>
    </div>

</div>

{% endblock %}

